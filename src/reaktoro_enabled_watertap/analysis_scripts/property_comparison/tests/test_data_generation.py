import pytest

from reaktoro_enabled_watertap.analysis_scripts.property_comparison.data_generation import (
    prop_sweep,
)
from reaktoro_enabled_watertap.utils.report_util import get_lib_path

from psPlotKit.data_manager.ps_data_manager import psDataManager
import os


@pytest.mark.component
def test_prop_sweep():
    work_path = get_lib_path()
    filename = str(
        work_path
        / "analysis_scripts/property_comparison/data_generation/output/prop_sweep_analysisType_prop_sweep.h5"
    )
    if os.path.exists(filename):
        os.remove(filename)

    prop_sweep.main()
    data_manager = psDataManager(
        filename,
    )
    data_manager.register_data_key(
        file_key="fs.water_recovery",
        return_key="Water recovery",
        units="%",
    )
    data_manager.register_data_key(
        file_key="fs.feed_tds",
        return_key="TDS",
    )
    data_manager.register_data_key(
        file_key="fs.modified_properties[osmoticPressure,H2O]",
        return_key=("Reaktoro", "osmotic pressure"),
        assign_units="Pa",
        conversion_factor=1e-5,
    )
    data_manager.register_data_key(
        file_key="fs.seawater_feed.properties[0.0].pressure_osm_phase[Liq]",
        return_key=("Watertap Seawater property package", "osmotic pressure"),
        units="bar",
    )
    data_manager.register_data_key(
        file_key="fs.nacl_feed.properties[0.0].pressure_osm_phase[Liq]",
        return_key=("Watertap NaCl property package", "osmotic pressure"),
        units="bar",
    )
    data_manager.register_data_key(
        file_key="fs.multicomp_feed.properties[0.0].dens_mass_phase[Liq]",
        return_key=("Reaktoro", "density"),
    )
    data_manager.register_data_key(
        file_key="fs.seawater_feed.properties[0.0].dens_mass_phase[Liq]",
        return_key=("Watertap Seawater property package", "density"),
    )
    data_manager.register_data_key(
        file_key="fs.nacl_feed.properties[0.0].dens_mass_phase[Liq]",
        return_key=("Watertap NaCl property package", "density"),
    )
    data_manager.register_data_key(file_key="fs.costing.LCOW", return_key="LCOW")
    data_manager.load_data()
    data_manager.display()
    test_data = {
        (("water_sim_cases", "BGW"), "Water recovery"): [
            50.0,
            51.0,
            52.0,
            53.0,
            54.0,
            55.00000000000001,
            56.00000000000001,
            57.00000000000001,
            57.99999999999999,
            59.0,
            60.0,
            61.0,
            62.0,
            63.0,
            64.0,
            65.0,
            66.0,
            67.0,
            68.0,
            69.0,
            70.0,
            71.0,
            72.0,
            73.0,
            74.0,
            75.0,
            76.0,
            77.0,
            78.0,
            79.0,
            80.0,
            81.0,
            82.0,
            83.0,
            84.00000000000001,
            85.00000000000001,
            86.0,
            87.0,
            88.0,
            89.0,
            90.0,
        ],
        (("water_sim_cases", "BGW"), "TDS"): [
            6.835665983881908,
            6.974899841493581,
            7.119925222115524,
            7.271111206516299,
            7.428858926216926,
            7.5936051163477085,
            7.765826153788799,
            7.946042660185322,
            8.134824747696793,
            8.332798063468191,
            8.540650717722151,
            8.759141272119118,
            8.98910799257548,
            9.23147960444638,
            9.48728784077444,
            9.75768212281756,
            10.043946818396783,
            10.347521680992411,
            10.670026060832424,
            11.013287822065047,
            11.379378020970917,
            11.770652743424673,
            12.189803863281849,
            12.639921125556874,
            13.12456845632872,
            13.647878580542985,
            14.214671179507526,
            14.830601855428025,
            15.50235159734071,
            16.23787022351497,
            17.04669255465445,
            17.94035427989584,
            18.93294589670123,
            20.041861387884314,
            21.28882686249289,
            22.701338779621754,
            24.314716219222014,
            26.17509594128081,
            28.343917995437955,
            30.904845054551462,
            33.9748099330802,
        ],
        (("water_sim_cases", "BGW"), ("Reaktoro", "osmotic pressure")): [
            3.5851887111541276,
            3.6556284494535145,
            3.72895053587169,
            3.8053367349684315,
            3.884984707482177,
            3.9681096269930176,
            4.05494612916127,
            4.145750584926875,
            4.240803200758111,
            4.340411594138089,
            4.444914066342519,
            4.554683333249684,
            4.670131044291098,
            4.791713071760598,
            4.919935837721306,
            5.055363308227765,
            5.198624841173654,
            5.350426161035182,
            5.511560524846107,
            5.6829233570232605,
            5.865528912972301,
            6.060530777291495,
            6.269245821018054,
            6.493185766863805,
            6.734094175654285,
            6.9939930810411255,
            7.275239692072469,
            7.580600012185896,
            7.913342456156252,
            8.27735769440348,
            8.677311874642024,
            9.11885418174964,
            9.608890754742438,
            10.15595214280445,
            10.770708999566775,
            11.466685324861881,
            12.261289731621313,
            13.177321049827103,
            14.245246712648642,
            15.50673792191232,
            17.02038200251838,
        ],
        (
            ("water_sim_cases", "BGW"),
            ("Watertap Seawater property package", "osmotic pressure"),
        ): [
            4.7846272467433195,
            4.882221419603453,
            4.983882854036374,
            5.089871380442969,
            5.200469460299551,
            5.31598470382654,
            5.43675273296754,
            5.5631404465759395,
            5.695549743754741,
            5.834421816424993,
            5.9802420727767815,
            6.133545818147046,
            6.2949248399104425,
            6.465035067554835,
            6.644605517370837,
            6.83444876681966,
            7.035473280382049,
            7.248698022032601,
            7.475269785091316,
            7.716483916132246,
            7.973809201670629,
            8.24891793733939,
            8.543722468458114,
            8.860419961841579,
            9.201547546798679,
            9.570050833044787,
            9.969369682178582,
            10.40354663048857,
            10.877365203595508,
            11.39652823238336,
            11.967890322518766,
            12.599764932671238,
            13.30233541413969,
            14.08821367687384,
            14.973212739747641,
            15.977435070396826,
            17.126839357819264,
            18.455551093758654,
            20.009366621701027,
            21.851240863861676,
            24.070213415897634,
        ],
        (
            ("water_sim_cases", "BGW"),
            ("Watertap NaCl property package", "osmotic pressure"),
        ): [
            5.295066166892514,
            5.403138441099823,
            5.515716704229564,
            5.633088897186326,
            5.755568043268383,
            5.883495038369022,
            6.01724182377194,
            6.157215004553706,
            6.303859975544776,
            6.457665677844969,
            6.619170054139019,
            6.788966342896723,
            6.967710373703388,
            7.156129053142565,
            7.355030272947279,
            7.565314511490282,
            7.787988484514779,
            8.02418132631389,
            8.275163777352395,
            8.542371126228938,
            8.827430755094053,
            9.132195414577472,
            9.458783650859848,
            9.809629326813011,
            10.187542594354106,
            10.595785633161821,
            11.038167425005033,
            11.519163504811107,
            12.04406865013022,
            12.61919361546215,
            13.252121442158247,
            13.952045766573107,
            14.730223253023182,
            15.600587868662263,
            16.580599276136518,
            17.69243625375962,
            18.96471172712679,
            20.43499666597859,
            22.15363789193,
            24.18971863554097,
            26.640716717383807,
        ],
        (("water_sim_cases", "BGW"), ("Reaktoro", "density")): [
            1003.9775231984338,
            1004.0952796403743,
            1004.217938272902,
            1004.345811707779,
            1004.4792397119376,
            1004.6185922224385,
            1004.7642727717132,
            1004.9167223896029,
            1005.0764240660061,
            1005.2439078570065,
            1005.4197567619309,
            1005.6046135045373,
            1005.7991883821542,
            1006.0042683848011,
            1006.2207278311381,
            1006.4495408293941,
            1006.6917959364765,
            1006.9487134650423,
            1007.2216660454571,
            1007.5122031532484,
            1007.8220805371831,
            1008.1532957260306,
            1008.5081311378749,
            1008.8892067326516,
            1009.2995448115782,
            1009.74265032818,
            1010.2226112527021,
            1010.7442250462417,
            1011.3131595569866,
            1011.9361597829496,
            1012.6213165394902,
            1013.3784197102142,
            1014.219428961853,
            1015.1591101541267,
            1016.2159096216645,
            1017.4131771334158,
            1018.780911124167,
            1020.3583065170918,
            1022.1975713312039,
            1024.369816120082,
            1026.9744601744176,
        ],
        (
            ("water_sim_cases", "BGW"),
            ("Watertap Seawater property package", "density"),
        ): [
            1003.2512267757132,
            1003.3573085028944,
            1003.4677790495341,
            1003.5829165789319,
            1003.7030232761215,
            1003.8284279956615,
            1003.9594892690465,
            1004.0965987303985,
            1004.2401850173492,
            1004.3907182629297,
            1004.5487152395218,
            1004.7147452848992,
            1004.8894371602328,
            1005.0734870142148,
            1005.267667665815,
            1005.4728394528375,
            1005.6899629713012,
            1005.9201141463127,
            1006.1645020612964,
            1006.4244902259842,
            1006.7016220463764,
            1006.9976515082624,
            1007.3145803452035,
            1007.6547034259772,
            1008.020664442895,
            1008.4155248314912,
            1008.8428496609947,
            1009.3068156851308,
            1009.8123484473047,
            1010.365297997543,
            1010.9726664741543,
            1011.6429065493213,
            1012.3863176515722,
            1013.2155795399281,
            1014.1464824866424,
            1015.198943666389,
            1016.3984503205298,
            1017.7781541639259,
            1019.3819883517639,
            1021.2694409566276,
            1023.523113047911,
        ],
        (("water_sim_cases", "BGW"), ("Watertap NaCl property package", "density")): [
            1002.5416769691211,
            1002.6402204914577,
            1002.7428476789635,
            1002.8498177914275,
            1002.9614125166684,
            1003.0779384470667,
            1003.19972989307,
            1003.3271520887199,
            1003.4606048427703,
            1003.6005267438541,
            1003.7473999774577,
            1003.9017558768102,
            1004.0641813485555,
            1004.2353263370413,
            1004.415912527227,
            1004.6067435190848,
            1004.808716779602,
            1005.0228377871571,
            1005.2502367716613,
            1005.4921886916068,
            1005.750137168796,
            1006.025723336112,
            1006.3208207997199,
            1006.6375783556005,
            1006.9784724318384,
            1007.3463720313526,
            1007.7446197211837,
            1008.1771335912979,
            1008.6485367320912,
            1009.1643233183165,
            1009.7310739173821,
            1010.3567381292098,
            1011.0510102517702,
            1011.8258358092227,
            1012.696105690422,
            1013.6806238850467,
            1014.8034839953142,
            1016.0960709388928,
            1017.6000468362605,
            1019.3719360211794,
            1021.4904076003766,
        ],
        (("water_sim_cases", "BGW_1500"), "Water recovery"): [
            50.0,
            51.0,
            52.0,
            53.0,
            54.0,
            55.00000000000001,
            56.00000000000001,
            57.00000000000001,
            57.99999999999999,
            59.0,
            60.0,
            61.0,
            62.0,
            63.0,
            64.0,
            65.0,
            66.0,
            67.0,
            68.0,
            69.0,
            70.0,
            71.0,
            72.0,
            73.0,
            74.0,
            75.0,
            76.0,
            77.0,
            78.0,
            79.0,
            80.0,
            81.0,
            82.0,
            83.0,
            84.00000000000001,
            85.00000000000001,
            86.0,
            87.0,
            88.0,
            89.0,
            90.0,
        ],
        (("water_sim_cases", "BGW_1500"), "TDS"): [
            5.355685150322795,
            5.464955753944631,
            5.578778399946276,
            5.697443595934378,
            5.821267103897179,
            5.950592751399366,
            6.085795619971301,
            6.227285677570748,
            6.3755119286508,
            6.530967172463564,
            6.694193483210638,
            6.865788524739309,
            7.046412860925121,
            7.236798453402894,
            7.437758580021456,
            7.6501994514280725,
            7.8751338652341545,
            8.113697356912851,
            8.367167381989884,
            8.636986193457297,
            8.924788306442368,
            9.232433645280707,
            9.562047768192956,
            9.9160710635193,
            10.297319279714232,
            10.70905858106375,
            11.155099364285345,
            11.639914514109627,
            12.168789965337295,
            12.748018229324513,
            13.385149943206525,
            14.08932487118343,
            14.871713217442048,
            15.746112569169656,
            16.72976871478276,
            17.84452460632665,
            19.11846155439661,
            20.58829760462743,
            22.30298455799946,
            24.329266014882805,
            26.760568553289726,
        ],
        (("water_sim_cases", "BGW_1500"), ("Reaktoro", "osmotic pressure")): [
            1.626471774283672,
            1.656867782940743,
            1.6884577565130898,
            1.7213140920649384,
            1.7555151219556482,
            1.791145879071072,
            1.8282988008853003,
            1.8670745459897897,
            1.9075828698879747,
            1.9499436564805601,
            1.9942882802343556,
            2.0407609687440127,
            2.089520372285696,
            2.140741430320875,
            2.1946175799712164,
            2.2513633380124585,
            2.3112170546982527,
            2.374444461611271,
            2.4413428974752343,
            2.5122460369613404,
            2.5875297720314534,
            2.6676191807109317,
            2.75299656025894,
            2.8442118237614187,
            2.9418948658120843,
            3.0467708945582523,
            3.1596792187702905,
            3.281596317352502,
            3.4136661525866328,
            3.557238020121406,
            3.7139145051627067,
            3.885614858291061,
            4.074658942964911,
            4.2838771818704355,
            4.516762225813435,
            4.777676688849011,
            5.072145607813438,
            5.407277701041876,
            5.792386648875836,
            6.239934560515086,
            6.76701881968006,
        ],
        (
            ("water_sim_cases", "BGW_1500"),
            ("Watertap Seawater property package", "osmotic pressure"),
        ): [
            3.7476776782372796,
            3.824213193383752,
            3.903941087977352,
            3.9870654217933406,
            4.0738080283622695,
            4.16441049799557,
            4.259136427642212,
            4.358273984984502,
            4.462138838979964,
            4.571077521206127,
            4.6854712986885945,
            4.805740638534522,
            4.932350379001,
            5.065815743492592,
            5.206709363837954,
            5.355669510872467,
            5.513409774923691,
            5.680730524162825,
            5.858532523613128,
            6.047833190961483,
            6.249786128926928,
            6.465704721448543,
            6.6970907984725265,
            6.945669734039879,
            7.213433685239284,
            7.502695282649627,
            7.816154845637878,
            8.156985254337537,
            8.52894021646122,
            8.936493733013306,
            9.385021824660678,
            9.881042323773688,
            10.432535601058703,
            11.049379990827852,
            11.74395305809253,
            12.531977415395025,
            13.433735959366361,
            14.475860113418877,
            15.694034219100844,
            17.137216910375244,
            18.874479184916467,
        ],
        (
            ("water_sim_cases", "BGW_1500"),
            ("Watertap NaCl property package", "osmotic pressure"),
        ): [
            4.146915580779625,
            4.231649941465991,
            4.319920225293829,
            4.4119525286927885,
            4.507992645894109,
            4.608308266893144,
            4.7131914711727845,
            4.822961569725341,
            4.9379683532308976,
            5.058595817710293,
            5.1852664570534905,
            5.318446211434834,
            5.458650198621505,
            5.606449379399127,
            5.7624783414018825,
            5.927444420709577,
            6.102138429916675,
            6.287447355887244,
            6.484369451076142,
            6.694032245588592,
            6.917714188187021,
            7.156870787564107,
            7.413166365687981,
            7.6885129329902275,
            7.985118073836529,
            8.305544396937131,
            8.652783947392953,
            9.030352144931916,
            9.442407584742618,
            9.893906313370215,
            10.390802780017351,
            10.940314882527794,
            11.551278291026474,
            12.234627192714226,
            13.004057656420914,
            13.876959984404024,
            14.87575685320733,
            16.029869851029613,
            17.378688739272352,
            18.976197024128847,
            20.89844596500475,
        ],
        (("water_sim_cases", "BGW_1500"), ("Reaktoro", "density")): [
            1003.4896329098508,
            1003.5975242082307,
            1003.7099108427776,
            1003.8270797386583,
            1003.949342770857,
            1004.0770395347475,
            1004.2105404960995,
            1004.3502505807955,
            1004.4966132776811,
            1004.6501153415223,
            1004.8112921991665,
            1004.9807341896297,
            1005.159093789743,
            1005.3470940108957,
            1005.5455381938856,
            1005.7553214832875,
            1005.977444329855,
            1006.2130284437735,
            1006.4633357379897,
            1006.7297909422625,
            1007.0140087362711,
            1007.3178264957041,
            1007.6433440613421,
            1007.9929723355483,
            1008.3694930969314,
            1008.7761331687785,
            1009.2166571275183,
            1009.6954842016801,
            1010.2178370318258,
            1010.7899329404055,
            1011.4192325816575,
            1012.1147670929205,
            1012.8875742799947,
            1013.7512887523869,
            1014.7229533024026,
            1015.8241548078781,
            1017.0826468743501,
            1018.5347212629867,
            1020.2287648311268,
            1022.2307562736777,
            1024.6330602268906,
        ],
        (
            ("water_sim_cases", "BGW_1500"),
            ("Watertap Seawater property package", "density"),
        ): [
            1002.1222527321229,
            1002.2056942507362,
            1002.2925971017485,
            1002.3831812341035,
            1002.4776856336239,
            1002.5763704327388,
            1002.6795193019076,
            1002.7874421725569,
            1002.900478346165,
            1003.0190000568219,
            1003.1434165716942,
            1003.2741789126001,
            1003.4117853181652,
            1003.5567875884245,
            1003.709798484427,
            1003.8715003875225,
            1004.0426554684507,
            1004.2241177050863,
            1004.4168471419292,
            1004.6219268787229,
            1004.8405834435204,
            1005.0742113524274,
            1005.3244028761505,
            1005.5929843983522,
            1005.8820610869294,
            1006.1940722018896,
            1006.5318601161115,
            1006.8987571635874,
            1007.2986960073051,
            1007.7363512114486,
            1008.2173228511919,
            1008.7483775326274,
            1009.3377688855574,
            1009.995669812892,
            1010.7347649362401,
            1011.5710769130515,
            1012.5251420278418,
            1013.6237203952094,
            1014.902347723281,
            1016.4092550852511,
            1018.2115967292871,
        ],
        (
            ("water_sim_cases", "BGW_1500"),
            ("Watertap NaCl property package", "density"),
        ): [
            1001.4933191434558,
            1001.5707779563896,
            1001.6514540672927,
            1001.7355521879782,
            1001.8232947723342,
            1001.9149239852653,
            1002.0107039349361,
            1002.1109232149174,
            1002.2158978073838,
            1002.3259744104012,
            1002.4415342683424,
            1002.5629975834897,
            1002.6908286207441,
            1002.8255416384288,
            1002.9677078069827,
            1003.1179633076001,
            1003.2770188456068,
            1003.4456708965049,
            1003.6248150539302,
            1003.8154619375928,
            1004.0187562769651,
            1004.235999925234,
            1004.4686797635387,
            1004.7185017988687,
            1004.987433077214,
            1005.2777536019335,
            1005.5921211587378,
            1005.933652931036,
            1006.306029281341,
            1006.7136269644718,
            1007.1616920230737,
            1007.6565669252901,
            1008.2059928651397,
            1008.8195178760612,
            1009.5090568050389,
            1010.289673295242,
            1011.1806938369676,
            1012.2073309852577,
            1013.4031096922971,
            1014.813602183291,
            1016.5023765445851,
        ],
        (("water_sim_cases", "BGW_500"), "Water recovery"): [
            50.0,
            51.0,
            52.0,
            53.0,
            54.0,
            55.00000000000001,
            56.00000000000001,
            57.00000000000001,
            57.99999999999999,
            59.0,
            60.0,
            61.0,
            62.0,
            63.0,
            64.0,
            65.0,
            66.0,
            67.0,
            68.0,
            69.0,
            70.0,
            71.0,
            72.0,
            73.0,
            74.0,
            75.0,
            76.0,
            77.0,
            78.0,
            79.0,
            80.0,
            81.0,
            82.0,
            83.0,
            84.00000000000001,
            85.00000000000001,
            86.0,
            87.0,
            88.0,
            89.0,
            90.0,
        ],
        (("water_sim_cases", "BGW_500"), "TDS"): [
            4.893645534302204,
            4.993447257684491,
            5.097404659798412,
            5.205782828301055,
            5.318869886672529,
            5.436979554978741,
            5.560454049951653,
            5.6896674033791275,
            5.825029245063124,
            5.966989141866964,
            6.116041586290853,
            6.272731747451235,
            6.437662138236221,
            6.611500360106736,
            6.7949881357351,
            6.988951887028502,
            7.194315177784318,
            7.412113427964674,
            7.6435113749337535,
            7.889823905092283,
            8.152541060364973,
            8.43335821483107,
            8.734212698318252,
            9.057328559154902,
            9.405271652999074,
            9.78101791405647,
            10.18803870625313,
            10.630408397561574,
            11.112941242916058,
            11.641367318745983,
            12.222561166166768,
            12.864842563549004,
            13.578377392429564,
            14.375719737236416,
            15.272557006678165,
            16.288752542343953,
            17.449834209693574,
            18.789168748317934,
            20.351220832584143,
            22.19658577163998,
            24.41003398496194,
        ],
        (("water_sim_cases", "BGW_500"), ("Reaktoro", "osmotic pressure")): [
            2.2967647488595957,
            2.3413834910158737,
            2.387810223389652,
            2.4361580757836028,
            2.486549813621475,
            2.5391190879406893,
            2.5940111526719627,
            2.651384720040879,
            2.711413385333376,
            2.7742874546519496,
            2.8402160356160633,
            2.9094290541984473,
            2.982180267047465,
            3.058750519283638,
            3.139451422774796,
            3.224629531413518,
            3.314671182872029,
            3.410009005286332,
            3.51112895211221,
            3.618578244778698,
            3.732975759513307,
            3.855024535224042,
            3.9855261612926762,
            4.125398828576766,
            4.275699857249475,
            4.437652050274555,
            4.61267854023281,
            4.802445588532459,
            5.0089173303945795,
            5.234425010987738,
            5.4817568959377905,
            5.754278095403715,
            6.056088431324159,
            6.39223293711065,
            6.768995423990795,
            7.194304694432925,
            7.678310766357216,
            8.234231174611445,
            8.879604886671117,
            9.63823394847334,
            10.543270341057001,
        ],
        (
            ("water_sim_cases", "BGW_500"),
            ("Watertap Seawater property package", "osmotic pressure"),
        ): [
            3.424095745541198,
            3.4939847987052715,
            3.566787150170789,
            3.6426888905951342,
            3.7218923084919187,
            3.80461769438012,
            3.891105384596448,
            3.98161810052857,
            4.076443616205786,
            4.175897819018406,
            4.280328229852209,
            4.390118062756481,
            4.505690933197989,
            4.627516329712225,
            4.7561159983768935,
            4.892071423344367,
            5.036032630741329,
            5.18872860585366,
            5.350979662925719,
            5.523712212746039,
            5.707976502900512,
            5.904968043252463,
            6.116053632035081,
            6.3428031969182115,
            6.587029023397977,
            6.850834428334609,
            7.136674690413729,
            7.447433958241294,
            7.786523272688552,
            8.158006786901241,
            8.566766142850472,
            9.01871721472561,
            9.521099763484456,
            10.082870362136331,
            10.71524442027345,
            11.432457803256263,
            12.252859632923176,
            13.200517938812823,
            14.307643431265062,
            15.618364798484741,
            17.19482813988169,
        ],
        (
            ("water_sim_cases", "BGW_500"),
            ("Watertap NaCl property package", "osmotic pressure"),
        ): [
            3.788686722745933,
            3.8660566827635585,
            3.946653160440944,
            4.030682324747539,
            4.118368294796796,
            4.209955139496839,
            4.305709142862207,
            4.405921396768514,
            4.510910757675382,
            4.621027239097582,
            4.736655913293622,
            4.858221410968062,
            4.986193139834124,
            5.121091349275339,
            5.263494206686284,
            5.414046088527191,
            5.5734673379416,
            5.7425658101257016,
            5.922250581352334,
            6.1135483147408465,
            6.317622919456349,
            6.535799292389314,
            6.76959215579542,
            7.020741335151025,
            7.291255217376398,
            7.58346466628043,
            7.900090505485647,
            8.24432868305624,
            8.619958795679691,
            9.031483798718536,
            9.484311899995983,
            9.984996321014421,
            10.541555584297418,
            11.163907784162125,
            11.864469298145725,
            12.658995466086155,
            13.567785790014971,
            14.617452856016511,
            15.843589052368536,
            17.294913423850925,
            19.03995737092759,
        ],
        (("water_sim_cases", "BGW_500"), ("Reaktoro", "density")): [
            1002.6010450981555,
            1002.6907629309671,
            1002.7842172491295,
            1002.8816464349588,
            1002.9833095894047,
            1003.0894888321617,
            1003.2004919178552,
            1003.3166552133481,
            1003.4383471025991,
            1003.5659718887371,
            1003.6999742813373,
            1003.8408445748547,
            1003.9891246418277,
            1004.1454148980637,
            1004.310382428466,
            1004.4847705054076,
            1004.6694097858249,
            1004.8652315396542,
            1005.0732833593714,
            1005.2947479094482,
            1005.5309654194258,
            1005.7834608265896,
            1006.0539767335972,
            1006.344513681234,
            1006.6573797045346,
            1006.9952517778154,
            1007.3612525972999,
            1007.7590473777993,
            1008.1929670184406,
            1008.6681664210537,
            1009.1908302481178,
            1009.7684435681957,
            1010.410152601982,
            1011.1272526203734,
            1011.9338585133135,
            1012.8478431716825,
            1013.8921773533158,
            1015.0968867891994,
            1016.5019859312829,
            1018.1620084163802,
            1020.1532493451622,
        ],
        (
            ("water_sim_cases", "BGW_500"),
            ("Watertap Seawater property package", "density"),
        ): [
            1001.7692756897618,
            1001.8455406023025,
            1001.9249688384004,
            1002.0077613893583,
            1002.0941366424039,
            1002.1843323066395,
            1002.2786075929961,
            1002.3772457074973,
            1002.4805566919164,
            1002.588880680197,
            1002.702591640102,
            1002.8221016839595,
            1002.947866063002,
            1003.0803889649582,
            1003.220230270792,
            1003.3680134614282,
            1003.5244349107936,
            1003.690274866373,
            1003.8664104679269,
            1004.0538312643579,
            1004.2536578218757,
            1004.467164155594,
            1004.6958049223978,
            1004.9412486171656,
            1005.2054183742764,
            1005.4905424622804,
            1005.7992173181505,
            1006.134486866584,
            1006.4999432756454,
            1006.8998562146888,
            1007.3393404951987,
            1007.8245761078243,
            1008.3631007711014,
            1008.9642044914242,
            1009.6394702853337,
            1010.4035282899049,
            1011.2751284793751,
            1012.2787010521488,
            1013.4466842053857,
            1014.8230992982711,
            1016.4692297575107,
        ],
        (
            ("water_sim_cases", "BGW_500"),
            ("Watertap NaCl property package", "density"),
        ): [
            1001.1656934057822,
            1001.2364749679501,
            1001.310195870019,
            1001.3870430969409,
            1001.4672198373248,
            1001.5509472796551,
            1001.6384666457436,
            1001.7300415167707,
            1001.8259604839002,
            1001.9265401873705,
            1002.032128809085,
            1002.143110097218,
            1002.2599080299588,
            1002.3829922305141,
            1002.5128842794006,
            1002.6501651028532,
            1002.7954836588586,
            1002.9495672031659,
            1003.1132334643087,
            1003.2874051592515,
            1003.4731274063513,
            1003.6715887232706,
            1003.8841464911279,
            1004.1123580523139,
            1004.3580189486385,
            1004.6232102648706,
            1004.910357757464,
            1005.2223062979801,
            1005.5624144881828,
            1005.9346761145258,
            1006.3438777733711,
            1006.7958059130322,
            1007.2975223267841,
            1007.8577360410154,
            1008.487313471668,
            1009.1999906965472,
            1010.0133879259303,
            1010.9504872626385,
            1012.0418408129559,
            1013.328968474909,
            1014.8697670769575,
        ],
        (("water_sim_cases", "SW"), "Water recovery"): [
            50.0,
            51.0,
            52.0,
            53.0,
            54.0,
            55.00000000000001,
            56.00000000000001,
            57.00000000000001,
            57.99999999999999,
            59.0,
            60.0,
            61.0,
            62.0,
            63.0,
            64.0,
            65.0,
            66.0,
            67.0,
            68.0,
            69.0,
            70.0,
            71.0,
            72.0,
            73.0,
            74.0,
            75.0,
            76.0,
            77.0,
            78.0,
            79.0,
            80.0,
            81.0,
            82.0,
            83.0,
            84.00000000000001,
            85.00000000000001,
            86.0,
            87.0,
            88.0,
            89.0,
            90.0,
        ],
        (("water_sim_cases", "SW"), "TDS"): [
            68.18345175258048,
            69.55242301589101,
            70.97749290626078,
            72.4621818231431,
            74.01031101418421,
            75.62603541505051,
            77.31388088552289,
            79.0787865461755,
            80.92615304866206,
            82.86189777258733,
            84.89251814089775,
            87.02516447586972,
            89.26772411798794,
            91.62891889694137,
            94.11841848926349,
            96.7469727699063,
            99.52656697792001,
            102.47060441821752,
            105.59412257174309,
            108.91404997098319,
            112.44951309739163,
            116.22220504775453,
            120.25683097225364,
            124.58164960727768,
            129.22913598784166,
            134.2367981910392,
            139.64819155672484,
            145.5141884200748,
            151.89458171516745,
            158.8601295371628,
            166.49518889338609,
            174.90114656562423,
            184.2009434499574,
            194.54512142851254,
            206.12002575797493,
            219.15911535826544,
            233.95884676326264,
            250.90144609312725,
            270.48832607759084,
            293.39046932938265,
            320.5268357874159,
        ],
        (("water_sim_cases", "SW"), ("Reaktoro", "osmotic pressure")): [
            49.70815806700132,
            50.789385745360704,
            51.91945838191518,
            53.101782687522395,
            54.34008857583152,
            55.63847017533641,
            57.00143019379154,
            58.43393366777529,
            59.94146847542529,
            61.530112933628516,
            63.206622581024334,
            64.97852519166783,
            66.85422936632169,
            68.8431613006013,
            70.95591998914321,
            73.20446530309219,
            75.60234359195407,
            78.16495965562146,
            80.90989871468463,
            83.85732545667277,
            87.03046968881092,
            90.4562304223149,
            94.16591935166346,
            98.19619096681105,
            102.59021713014356,
            107.39919044226869,
            112.68424378385834,
            118.51894143045162,
            124.99255779575168,
            132.21442683266176,
            140.3197804364652,
            149.47773833951285,
            159.9023531481468,
            171.86819760018392,
            185.73274258339148,
            201.96919310401455,
            221.21581337989383,
            244.35188245444854,
            272.6187572198766,
            307.8188918831184,
            352.6578926976407,
        ],
        (
            ("water_sim_cases", "SW"),
            ("Watertap Seawater property package", "osmotic pressure"),
        ): [
            49.89433615615857,
            50.97997636369292,
            52.11514913047522,
            53.303380558619175,
            54.548542534909906,
            55.85489630175554,
            57.227142776116224,
            58.67048086453666,
            60.19067528914711,
            61.794135775170695,
            63.488009874620396,
            65.28029222428981,
            67.179953714046,
            69.19709490275432,
            71.34312911576112,
            73.63100208911459,
            76.07545688277436,
            78.69335522071162,
            81.50406963749961,
            84.52996511470262,
            87.79699466269017,
            91.33544115660527,
            95.18084849246841,
            99.375200047647,
            103.96842333059944,
            109.02032934896667,
            114.60313783438657,
            120.80480153737155,
            127.73343459696406,
            135.5232879874666,
            144.34292614798903,
            154.4065879218079,
            165.99023905729868,
            179.45467694702097,
            195.2794747262382,
            214.11400298715012,
            236.85611524989852,
            264.777076120429,
            299.7266040426797,
            344.4825999762848,
            403.37519763074806,
        ],
        (
            ("water_sim_cases", "SW"),
            ("Watertap NaCl property package", "osmotic pressure"),
        ): [
            54.930036409868414,
            56.10765741450352,
            57.337886324222346,
            58.624380456852656,
            59.97114734910105,
            61.38258790090722,
            62.86354606268168,
            64.41936625220892,
            66.05595993650245,
            67.77988312588671,
            69.59842692069128,
            71.5197237322877,
            73.55287242304465,
            75.70808639672683,
            77.99686966611655,
            80.43222721868875,
            83.02891766907946,
            85.80375836035132,
            88.77599593051127,
            91.96775914551618,
            95.40461582930315,
            99.11626250062461,
            103.1373845097475,
            107.5087370493142,
            112.27851479156654,
            117.50410215374646,
            123.25433039943188,
            129.61241652109732,
            136.67982904136787,
            144.58142811714984,
            153.47237783156132,
            163.54755214857997,
            175.05449143919634,
            188.31147152700674,
            203.7330080109226,
            221.86624884490638,
            243.44332188637176,
            269.4567634898587,
            301.26686525322947,
            340.74742695424345,
            390.4551683174111,
        ],
        (("water_sim_cases", "SW"), ("Reaktoro", "density")): [
            1050.6143611599573,
            1051.6668341825293,
            1052.762442921397,
            1053.9038947578715,
            1055.0941284875914,
            1056.3363395841138,
            1057.6340088486272,
            1058.9909349833263,
            1060.4112717323505,
            1061.8995703566916,
            1063.4608283492623,
            1065.100545500129,
            1066.8247886360175,
            1068.6402666298563,
            1070.5544176460771,
            1072.5755110097016,
            1074.7127666388037,
            1076.976495680957,
            1079.3782668911117,
            1081.9311043968744,
            1084.64972400345,
            1087.5508170788507,
            1090.6533936070755,
            1093.9791993067217,
            1097.5532261605504,
            1101.404341703771,
            1105.5660706448202,
            1110.0775736314822,
            1114.984883713282,
            1120.3424833505458,
            1126.215336720817,
            1132.6815384076622,
            1139.8358084681586,
            1147.7941672686457,
            1156.7002829662936,
            1166.7342349675691,
            1178.1248406818095,
            1191.1673622563894,
            1206.2495534906623,
            1223.891029901763,
            1244.8046509891487,
        ],
        (
            ("water_sim_cases", "SW"),
            ("Watertap Seawater property package", "density"),
        ): [
            1048.0102465083494,
            1048.9674909164369,
            1049.962195142604,
            1050.9966071104848,
            1052.0731586899844,
            1053.1944849487409,
            1054.3634458774786,
            1055.5831509704835,
            1056.8569871089514,
            1058.1886502777568,
            1059.5821817491076,
            1061.0420094823899,
            1062.5729956426635,
            1064.1804913251833,
            1065.8703997939242,
            1067.6492498265618,
            1069.524281107932,
            1071.5035440522795,
            1073.5960169888726,
            1075.8117443559315,
            1078.1620004442343,
            1080.6594843985974,
            1083.3185536921073,
            1086.1555052674623,
            1089.1889161474674,
            1092.4400587883952,
            1095.9334111282292,
            1099.6972876357036,
            1103.7646263907475,
            1108.1739793824893,
            1112.9707703482004,
            1118.2089089049741,
            1123.9528853429224,
            1130.2805228103941,
            1137.286642598129,
            1145.0880192512172,
            1153.8301925024887,
            1163.697010329113,
            1174.9242862568346,
            1187.8198386932404,
            1202.7937723089906,
        ],
        (("water_sim_cases", "SW"), ("Watertap NaCl property package", "density")): [
            1044.7108412847863,
            1045.6263524753856,
            1046.5783313777579,
            1047.5690080382535,
            1048.6007986763393,
            1049.676325586631,
            1050.7984396564548,
            1051.970245911447,
            1053.195132575812,
            1054.4768042260969,
            1055.8193197321377,
            1057.227135810199,
            1058.7051571858763,
            1060.2587945743694,
            1061.8940319391304,
            1063.6175048166115,
            1065.4365918999692,
            1067.3595225860468,
            1069.3955038412898,
            1071.554870582105,
            1073.8492648362992,
            1076.291850355764,
            1078.8975711814276,
            1081.6834650885041,
            1084.669046071921,
            1087.876774382905,
            1091.332638558606,
            1095.0668820462786,
            1099.1149183845084,
            1103.5184949609381,
            1108.3271883634795,
            1113.6003477143988,
            1119.4096518827605,
            1125.8425208124027,
            1133.006735689307,
            1141.0368023779517,
            1150.102882262805,
            1160.4235952305137,
            1172.284819791274,
            1186.0680804935785,
            1202.2948321527963,
        ],
    }
    for key in data_manager:
        # test_data[key] = data_manager[key].data.tolist()
        solved_data = data_manager[key].data
        for i, val in enumerate(test_data[key]):
            if val is None:
                assert solved_data[i] != solved_data[i]
            else:
                assert val == pytest.approx(solved_data[i], rel=1e-5)
    # print(test_data)
